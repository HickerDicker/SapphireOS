this is almost entirely taken from Rax <3